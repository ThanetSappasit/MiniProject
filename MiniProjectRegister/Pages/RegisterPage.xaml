<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MiniProjectRegister.Pages.RegisterPage"
             xmlns:viewmodel="clr-namespace:MiniProjectRegister.ViewModels"
             xmlns:model="clr-namespace:MauiApp1.Model"
             Shell.NavBarIsVisible="False"
             Padding="20"
             BackgroundColor="#FFDEE14C"
             Title="RegisterPage">

    <ScrollView>
        <Grid ColumnDefinitions="2*,*"
              RowDefinitions="*">
            
            <!-- Courses Column -->
            <CollectionView ItemsSource="{Binding Courses}"
                            Grid.Column="0"
                            Grid.Row="0">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border StrokeShape="RoundRectangle 10"
                                Stroke="#7C81AD"
                                StrokeThickness="1"
                                BackgroundColor="#F1F0E8"
                                Margin="0,0,0,10"
                                Padding="15">
                            <Grid RowDefinitions="Auto, Auto"
                                  ColumnDefinitions="*, Auto">
                                <!-- Course Details -->
                                <VerticalStackLayout Grid.Column="0"
                                                     Spacing="5">
                                    <Label Text="{Binding Coursename}"
                                           FontAttributes="Bold"
                                           TextColor="#2E4374"
                                           FontSize="16"/>
                                    <Label Text="{Binding Courseid, StringFormat='รหัสวิชา: {0}'}"
                                           TextColor="#7C81AD"/>
                                    <Label Text="{Binding Credits, StringFormat='หน่วยกิต: {0}'}"
                                           TextColor="#7C81AD"/>
                                    <Label Text="{Binding Instructor, StringFormat='อาจารย์ผู้สอน: {0}'}"
                                           TextColor="#7C81AD"/>
                                    <Label Text="{Binding Term, StringFormat='เทอมสอน: {0}'}"
                                           TextColor="#7C81AD"/>
                                    <Label Text="{Binding Year, StringFormat='ปีการศึกษา: {0}'}"
                                           TextColor="#7C81AD"/>
                                </VerticalStackLayout>

                                <!-- Select Course Button -->
                                <Button Grid.Column="1"
                                        Text="เลือกวิชานี้"
                                        BackgroundColor="#7C81AD"
                                        TextColor="White"
                                        Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.AddCourseCommand}"
                                        CommandParameter="{Binding}"
                                        CornerRadius="10"
                                        FontAttributes="Bold"
                                        WidthRequest="120"
                                        HorizontalOptions="End"
                                        VerticalOptions="Center"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Selected Courses Column -->
            <Border Grid.Column="1"
                    StrokeShape="RoundRectangle 15"
                    BackgroundColor="White"
                    Stroke="#2E4374"
                    StrokeThickness="1"
                    Padding="15">
                <VerticalStackLayout Spacing="10">
                    <!-- Selected Courses Header -->
                    <Border BackgroundColor="#2E4374"
                            StrokeShape="RoundRectangle 10"
                            Padding="10,5"
                            Margin="0,0,0,10">
                        <Label Text="รายวิชาที่เลือก"
                               FontSize="16"
                               TextColor="White"
                               VerticalOptions="Center"
                               HorizontalOptions="Center"
                               FontAttributes="Bold"/>
                    </Border>

                    <!-- Selected Courses List -->
                    <CollectionView ItemsSource="{Binding SelectedCourses}"
                                    EmptyView="ยังไม่ได้เลือกรายวิชา"
                                    Margin="0,0,0,10">
                        <CollectionView.EmptyViewTemplate>
                            <DataTemplate>
                                <VerticalStackLayout VerticalOptions="Center"
                                                     HorizontalOptions="Center"
                                                     Padding="20">
                                    <Label Text="ยังไม่ได้เลือกรายวิชา"
                                           TextColor="#7C81AD"
                                           FontSize="14"
                                           HorizontalOptions="Center"/>
                                </VerticalStackLayout>
                            </DataTemplate>
                        </CollectionView.EmptyViewTemplate>
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border StrokeShape="RoundRectangle 10"
                                        Stroke="#7C81AD"
                                        StrokeThickness="1"
                                        BackgroundColor="#F1F0E8"
                                        Margin="0,0,0,10"
                                        Padding="15">
                                    <Grid>
                                        <VerticalStackLayout Spacing="5">
                                            <Label Text="{Binding Coursename}"
                                                   FontAttributes="Bold"
                                                   TextColor="#2E4374"
                                                   FontSize="16"/>
                                            <Label Text="{Binding Courseid, StringFormat='รหัสวิชา: {0}'}"
                                                   TextColor="#7C81AD"/>
                                            <Label Text="{Binding Credits, StringFormat='หน่วยกิต: {0}'}"
                                                   TextColor="#7C81AD"/>
                                        </VerticalStackLayout>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <!-- Total Credits -->
                    <Border BackgroundColor="#F1F0E8"
                            StrokeShape="RoundRectangle 10"
                            Padding="15"
                            Margin="0,5,0,15">
                        <Label Text="{Binding TotalCredit, StringFormat='หน่วยกิตรวม: {0}'}"
                               TextColor="#2E4374"
                               FontAttributes="Bold"
                               FontSize="16"
                               HorizontalOptions="Start"/>
                    </Border>

                    <!-- Confirm Button -->
                    <Button Text="ยืนยันการลงทะเบียน"
                            BackgroundColor="#2E4374"
                            TextColor="White"
                            Command="{Binding ConfirmCommand}"
                            FontAttributes="Bold"
                            CornerRadius="10"
                            HeightRequest="50"
                            HorizontalOptions="Fill"
                            VerticalOptions="End"
                            Margin="0,10,0,0"/>
                </VerticalStackLayout>
            </Border>
        </Grid>
    </ScrollView>
</ContentPage>